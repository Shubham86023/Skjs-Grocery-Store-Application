<!DOCTYPE html>
<html class="no-js" lang="en" xmlns="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>Order Received | Skjs Grocery Store</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet"/>
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.2.0/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Cairo:400,600,700&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Poppins:600&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400i,700i" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Ubuntu&amp;display=swap" rel="stylesheet"/>
    <link href="assets/productImages/favicon.png" rel="shortcut icon" type="image/x-icon"/>
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/animate.min.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/nice-select.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/slick.min.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/style.css" rel="stylesheet" type="text/css"/>

    <th:block th:insert="~{themes}"></th:block>
    <link href="https://cdn.datatables.net/1.13.1/css/dataTables.bootstrap5.min.css" rel="stylesheet"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<style>
    .nice-select {
      width: 180px;
      right: 70px !important;
    }
    .search_button {
      width: 60px !important;
    }
    a {
      text-decoration: auto !important;
    }
    .block1_links {
      font-family: "Cairo";
      color: #7faf51 !important;
      font-size: 20px !important;
      text-decoration: underline !important;
    }
    .block1_links:hover {
      color: #e73918 !important;
      text-decoration: none !important;
    }
    .tbl_head {
      font-weight: 600;
    }
    .row {
      display: block;
    }
    .live-info {
      width: auto;
    }
    .dashboard_heading {
      text-align: center;
      letter-spacing: 2px;
      font-weight: 600;
      color: #e73918;
      width: 100%;
    }
    hr {
      border-top: 2px solid;
    }
    .dashboard_title {
      border-bottom: 1px solid lightgrey;
    }
    .x_panel_inner {
      padding: 10px 15px;
      border: 1px solid lightgray;
    }
    h3 {
      margin-top: 10px;
    }
    .dashboard_title h3 {
      margin-top: 0px;
      color: #7faf51;
      font-weight: 700;
    }
    .x_panel:hover {
      box-shadow: rgb(45 45 45 / 5%) 0px 2px 2px, rgb(49 49 49 / 5%) 0px 4px 4px, rgb(42 42 42 / 5%) 0px 8px 8px, rgb(32 32 32 / 5%) 0px 16px 16px, rgb(49 49 49 / 5%) 0px 32px 32px;
    }
    .cont_box {
      background-color: #f0f0f0;
      margin-top: 20px;
    }
</style>
<body class="biolife-body">
<!-- HEADER -->
<!-- row1 -->
<header class="header-area style-01 layout-03" id="header">
    <div th:insert="~{header_section1}"></div>
    <!-- row2 -->
    <div th:insert="~{header}"></div>
</header>

<!-- Page Contain -->
<div class="page-contain">
    <!-- Main content -->
    <div class="main-content" id="main-content">
        <!--Block 02: Product Tab-->
        <div class="product-tab z-index-20 sm-margin-top-150px">
            <div class="container cont_box">
                <div class="row">
                    <div class="x_title">
                        <h1 class="dashboard_heading">Orders Pending</h1>
                    </div>
                    <div class="clearfix"></div>
                </div>
            </div>
            <div class="container" style="margin-top: 15px">
                <div class="col-md-12" style="overflow: auto; white-space: nowrap">
                    <table class="table order-list table table-striped responsive-utilities jambo_table bulk_action product_list">
                        <thead>
                        <tr>
                            <th class="tbl_head">S.No.</th>
                            <th class="tbl_head">Order ID</th>
                            <th class="tbl_head">Seller's SKU</th>
                            <th class="tbl_head">Image</th>
                            <th class="tbl_head">Product Name</th>
                            <th class="tbl_head">Qty</th>
                            <th class="tbl_head">Order Time</th>
                            <th class="tbl_head">Customer Moblie No.</th>
                            <th class="tbl_head">Customer Address</th>
                            <th class="tbl_head">Action</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="order, iterationStatus : ${ordersPending}">
                            <td th:text="${iterationStatus.index + 1}"></td>
                            <td th:text="${order[0]}"></td>
                            <td th:text="${order[3]}"></td>
                            <td><img class="product-thumnail"
                                     height="50"
                                     th:alt="${order[2]}" th:if="${order[2] != null}"
                                     th:src="@{productImages/product1/{pid}/{name}(name=${order[2]},pid=${order[1]})}"
                                     width="50"/> <span
                                    th:if="${order[2] == null}">N/A</span></td>
                            <td th:text="${order[4]}"></td>
                            <td th:text="${order[5]}"></td>
                            <td th:text="${order[6]}"></td>
                            <td th:text="${(order[7] == 'user') ? order[9]:order[8] }"></td>
                            <td th:text="${order[10]}"></td>
                            <td style="width: 270px">
                                <input class="pinNo" placeholder="Enter PIN.." type="number"/>
                                <a class="btn btn-primary deliver_but" th:oiid="${order[11]}" title="deliver"><i
                                        aria-hidden="true" class="fa fa-paper-plane"></i> Deliver</a>
                                <p class="error" style="color: red; display: none"></p>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <hr/>
            <div class="container cont_box">
                <div class="row">
                    <div class="x_title">
                        <h1 class="dashboard_heading" style="color: green">Orders Completed</h1>
                    </div>
                    <div class="clearfix"></div>
                </div>
            </div>
            <div class="container" style="margin-top: 15px">
                <div class="col-md-12" style="overflow: auto; white-space: nowrap">
                    <table class="table order-list table table-striped responsive-utilities jambo_table bulk_action product_list">
                        <thead>
                        <tr>
                            <th class="tbl_head">S.No.</th>
                            <th class="tbl_head">Order ID</th>
                            <th class="tbl_head">Seller's SKU</th>
                            <th class="tbl_head">Image</th>
                            <th class="tbl_head">Product Name</th>
                            <th class="tbl_head">Qty</th>
                            <th class="tbl_head">Delivery Time</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="order, iterationStatus : ${ordersCompleted}">
                            <td th:text="${iterationStatus.index + 1}"></td>
                            <td th:text="${order[0]}"></td>
                            <td th:text="${order[3]}"></td>
                            <td><img class="product-thumnail"
                                     height="50"
                                     th:alt="${order[2]}" th:if="${order[2] != null}"
                                     th:src="@{productImages/product1/{pid}/{name}(name=${order[2]},pid=${order[1]})}"
                                     width="50"/> <span
                                    th:if="${order[2] == null}">N/A</span></td>
                            <td th:text="${order[4]}"></td>
                            <td th:text="${order[5]}"></td>
                            <td th:text="${order[6]}"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- FOOTER -->
<div style="margin-top: 50px" th:insert="~{footer}"></div>

<!--Footer For Mobile-->
<div th:insert="~{footer_section1}"></div>

<!-- Scroll Top Button -->
<a class="btn-scroll-top"><i class="biolife-icon icon-left-arrow"></i></a>

<script src="assets/js/jquery-3.4.1.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/jquery.countdown.min.js"></script>
<script src="assets/js/jquery.nice-select.min.js"></script>
<script src="assets/js/jquery.nicescroll.min.js"></script>
<script src="assets/js/slick.min.js"></script>
<script src="assets/js/biolife.framework.js"></script>
<script src="assets/js/functions.js"></script>
<script crossorigin="anonymous"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU="
        src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha256-xLD7nhI62fcsEZK2/v8LsBcb4lG7dgULkuXoXB/j91c="
        src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>

<script src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.1/js/dataTables.bootstrap5.min.js"></script>

<script type="text/javascript">
    var table;
    $(document).ready(function () {
      table = $(".product_list").DataTable();

      $(document).on("click", ".deliver_but", function () {
        var oiid = $(this).attr("oiid");
        var row = $(this).closest("td");
        var pinNo = row.find(".pinNo").val();

        if (pinNo != "") {
          $.ajax({
            url: "/deliverProduct",
            type: "POST",
            data: {
              oiid: oiid,
              pinNo: pinNo,
            },
            success: function (result) {
              if (result) {
                row.find(".error").css("display", "none");
                row.find(".error").text("");
                location.reload();
              } else {
                row.find(".error").css("display", "block");
                row.find(".error").text("Incorrect PIN Number.");
              }
            },
          });
        } else {
          row.find(".error").css("display", "block");
          row.find(".error").text("Enter PIN Correctly");
        }
      });
    });
</script>
</body>
</html>
